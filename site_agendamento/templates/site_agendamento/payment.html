{% extends "global/partials/base.html" %}
{% load static %}

{% block css-content %}
    <link rel="stylesheet" href="{% static 'global/css/payment.css' %}">
{% endblock css-content %}

{% block content %}

{% block mensagem %}
    {% if mensagem %}   
        <p class="mensagem-erro">{{ mensagem }}</p>
    {% endif %}
{% endblock mensagem %}

<div class="container">
    <!-- Resumo do Serviço -->
    <div class="box box-resume">
        <h2>Resumo do Serviço</h2>
        {% if mensagem %}
            <p style="color: red;">{{ mensagem }}</p>
        {% else %}
            <img src="{{ service.image.url }}" alt="{{ service.name }}">
            <h3>{{ service.name }}</h3>
            <p><strong>Duração:</strong> {{ service.duration }} minutos</p>
            <p><strong>Tipo de serviço:</strong> {{ service_type }}</p>
            <p><strong>Data:</strong> {{ date }}</p>
            <p><strong>Horário:</strong> {{ time }}</p>
            <p><strong>Valor Total:</strong> R$ {{ service.application }}</p>
        {% endif %}
    </div>
    <!-- Formulário de Cliente + Pagamento -->
    <div class="box box-payment">
        <h2>Confirme Seus Dados:</h2>
        <form id="customer-form">
            {% csrf_token %}

            <!-- Entrada de Nome e Telefone -->
            <div class="input-row">
                <div class="input-group">
                    <label for="name">Nome completo:</label>
                    {% if user.name == "" %}
                        <input type="text" id="name" name="name" placeholder="Vivian Leonardo Sales">
                    {% else %}
                        <input type="text" id="name" name="name" placeholder="Vivian Leonardo Sales" value=" {{user.name}} ">
                    {% endif %}
                    
                </div>
                <div class="input-group">
                    <label for="phone">Telefone:</label>
                    <input type="text" id="phone" name="phone" placeholder="(11) 96829-9535" value =" {{ user.phone }} ">
                </div>
            </div>
        </form>
        <!-- Opções de Pagamento -->
       
        <form id="payment-form">
            <button type="button" class="btn-pay" onclick="showModal()">Gerar QR Code</button>
        </form>
    </div>
</div>

<!-- Modal de Pagamento -->
<div id="payment-modal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal()">&times;</span>
        <h3>Escaneie o QR Code para realizar o pagamento</h3>
        <img id="qrcode" src="{% static 'global/images/qrcode-placeholder.png' %}" alt="QR Code de Pagamento">
        <p>Após o pagamento, sua reserva será confirmada.</p>
    </div>
</div>

<script src='https://code.jquery.com/jquery-3.7.1.min.js'></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.js"></script>
<script>$('#phone').mask('(00) 00000-0000', {placeholder: "(11) 96829-9535"});</script>
<script>
    function showModal() {
        document.getElementById("payment-modal").classList.add("active");
    }
    
    function closeModal() {
        document.getElementById("payment-modal").classList.remove("active");
    }

    function validateCustomer() {
        const phone = document.getElementById("phone").value;
        const name = document.getElementById("name").value;
        
        if (phone && name) {
            alert("Dados confirmados!");
        } else {
            alert("Por favor, preencha todos os campos.");
        }
    }
</script>
{% endblock content %}
